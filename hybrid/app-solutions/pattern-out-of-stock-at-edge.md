---
title: Detecção de indisponibilidade de estoque usando o Azure e o Azure Stack Edge
description: Saiba como usar os serviços do Azure e do Azure Stack Edge para implementar a detecção de indisponibilidade de estoque.
author: BryanLa
ms.topic: article
ms.date: 05/24/2021
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 05/24/2021
ms.openlocfilehash: b25a6391c4e64fa7018031bac4fb7d098c56b529
ms.sourcegitcommit: cf2c4033d1b169f5b63980ce1865281366905e2e
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/25/2021
ms.locfileid: "110343868"
---
# <a name="out-of-stock-detection-at-the-edge-pattern"></a><span data-ttu-id="521e3-103">Padrão de detecção de indisponibilidade de estoque na borda</span><span class="sxs-lookup"><span data-stu-id="521e3-103">Out of stock detection at the edge pattern</span></span>

<span data-ttu-id="521e3-104">Este padrão ilustra como determinar se as prateleiras têm itens fora de estoque usando um dispositivo do Azure Stack Edge ou Azure IoT Edge e câmeras de rede.</span><span class="sxs-lookup"><span data-stu-id="521e3-104">This pattern illustrates how to determine if shelves have out of stock items using an Azure Stack Edge or Azure IoT Edge device and network cameras.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="521e3-105">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="521e3-105">Context and problem</span></span>

<span data-ttu-id="521e3-106">Lojas de varejo físicas perdem vendas porque, quando os clientes procuram um item, ele não está disponível nas prateleiras.</span><span class="sxs-lookup"><span data-stu-id="521e3-106">Physical retail stores lose sales because when customers look for an item, it's not present on the shelf.</span></span> <span data-ttu-id="521e3-107">No entanto, o item pode estar no depósito da loja e ainda não ter sido reposto.</span><span class="sxs-lookup"><span data-stu-id="521e3-107">However, the item could have been in the back of the store and not been restocked.</span></span> <span data-ttu-id="521e3-108">As lojas gostariam de usar suas equipes com mais eficiência e de ser notificadas automaticamente quando os itens precisarem ser repostos.</span><span class="sxs-lookup"><span data-stu-id="521e3-108">Stores would like to use their staff more efficiently and get automatically notified when items need restocking.</span></span>

## <a name="solution"></a><span data-ttu-id="521e3-109">Solução</span><span class="sxs-lookup"><span data-stu-id="521e3-109">Solution</span></span>

<span data-ttu-id="521e3-110">A solução de exemplo usa em cada loja um dispositivo de borda, como um Azure Stack Edge, que processa com eficiência os dados das câmeras na loja.</span><span class="sxs-lookup"><span data-stu-id="521e3-110">The solution example uses an edge device, like an Azure Stack Edge in each store, which efficiently processes data from cameras in the store.</span></span> <span data-ttu-id="521e3-111">Esse design otimizado permite que as lojas enviem apenas imagens e eventos relevantes para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="521e3-111">This optimized design lets stores send only relevant events and images to the cloud.</span></span> <span data-ttu-id="521e3-112">O design economiza largura de banda e espaço de armazenamento e garante a privacidade dos clientes.</span><span class="sxs-lookup"><span data-stu-id="521e3-112">The design saves bandwidth, storage space, and ensures customer privacy.</span></span> <span data-ttu-id="521e3-113">À medida que os quadros são lidos de cada câmera, um modelo de ML processa a imagem e retorna as áreas sem estoque.</span><span class="sxs-lookup"><span data-stu-id="521e3-113">As frames are read from each camera, an ML model processes the image and returns any out of stock areas.</span></span> <span data-ttu-id="521e3-114">A imagem e as áreas sem estoque são exibidas em um aplicativo Web local.</span><span class="sxs-lookup"><span data-stu-id="521e3-114">The image and out of stock areas are displayed on a local web app.</span></span> <span data-ttu-id="521e3-115">Esses dados podem ser enviados a um ambiente do Time Series Insights para exibir insights no Power BI.</span><span class="sxs-lookup"><span data-stu-id="521e3-115">This data can be sent to a Time Series Insight environment to show insights in Power BI.</span></span>

![Arquitetura da solução de borda de indisponibilidade de estoque](media/pattern-out-of-stock-at-edge/solution-architecture.png)

<span data-ttu-id="521e3-117">Veja como a solução funciona:</span><span class="sxs-lookup"><span data-stu-id="521e3-117">Here's how the solution works:</span></span>

1. <span data-ttu-id="521e3-118">As imagens são capturadas de uma câmera de rede por HTTP ou RTSP.</span><span class="sxs-lookup"><span data-stu-id="521e3-118">Images are captured from a network camera over HTTP or RTSP.</span></span>
2. <span data-ttu-id="521e3-119">A imagem é redimensionada e enviada ao driver de inferência, que se comunica com o modelo de ML para determinar se há alguma imagem com indisponibilidade de estoque.</span><span class="sxs-lookup"><span data-stu-id="521e3-119">The image is resized and sent to the inference driver, which communicates with the ML model to determine if there are any out of stock images.</span></span>
3. <span data-ttu-id="521e3-120">O modelo de ML retorna as áreas em que há indisponibilidade de estoque.</span><span class="sxs-lookup"><span data-stu-id="521e3-120">The ML model returns any out of stock areas.</span></span>
4. <span data-ttu-id="521e3-121">O driver de inferência carrega a imagem bruta em um blob (se especificado) e envia os resultados do modelo ao Hub IoT do Azure e um processador de caixa delimitadora no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="521e3-121">The inferencing driver uploads the raw image to a blob (if specified), and sends the results from the model to Azure IoT Hub and a bounding box processor on the device.</span></span>
5. <span data-ttu-id="521e3-122">O processador de caixa delimitadora adiciona caixas delimitadoras à imagem e armazena em cache o caminho da imagem em um banco de dados na memória.</span><span class="sxs-lookup"><span data-stu-id="521e3-122">The bounding box processor adds bounding boxes to the image and caches the image path in an in-memory database.</span></span>
6. <span data-ttu-id="521e3-123">O aplicativo Web consulta imagens e as mostra na ordem recebida.</span><span class="sxs-lookup"><span data-stu-id="521e3-123">The web app queries for images and shows them in the order received.</span></span>
7. <span data-ttu-id="521e3-124">As mensagens do Hub IoT são agregadas no Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="521e3-124">Messages from IoT Hub are aggregated in Time Series Insights.</span></span>
8. <span data-ttu-id="521e3-125">O Power BI exibe um relatório interativo de itens fora de estoque ao longo do tempo com os dados do Time Series Insights.</span><span class="sxs-lookup"><span data-stu-id="521e3-125">Power BI displays an interactive report of out of stock items over time with the data from Time Series Insights.</span></span>


## <a name="components"></a><span data-ttu-id="521e3-126">Componentes</span><span class="sxs-lookup"><span data-stu-id="521e3-126">Components</span></span>

<span data-ttu-id="521e3-127">Esta solução usa os seguintes componentes:</span><span class="sxs-lookup"><span data-stu-id="521e3-127">This solution uses the following components:</span></span>

| <span data-ttu-id="521e3-128">Camada</span><span class="sxs-lookup"><span data-stu-id="521e3-128">Layer</span></span> | <span data-ttu-id="521e3-129">Componente</span><span class="sxs-lookup"><span data-stu-id="521e3-129">Component</span></span> | <span data-ttu-id="521e3-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="521e3-130">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="521e3-131">Hardware local</span><span class="sxs-lookup"><span data-stu-id="521e3-131">On-premises hardware</span></span> | <span data-ttu-id="521e3-132">Câmera de rede</span><span class="sxs-lookup"><span data-stu-id="521e3-132">Network camera</span></span> | <span data-ttu-id="521e3-133">Uma câmera de rede é necessária, com um feed HTTP ou RTSP, para fornecer as imagens para inferência.</span><span class="sxs-lookup"><span data-stu-id="521e3-133">A network camera is required, with either an HTTP or RTSP feed to provide the images for inference.</span></span> |
| <span data-ttu-id="521e3-134">Azure</span><span class="sxs-lookup"><span data-stu-id="521e3-134">Azure</span></span> | <span data-ttu-id="521e3-135">Hub IoT do Azure</span><span class="sxs-lookup"><span data-stu-id="521e3-135">Azure IoT Hub</span></span> | <span data-ttu-id="521e3-136">O [Hub IoT do Azure](/azure/iot-hub/) manipula o provisionamento de dispositivos e as mensagens para os dispositivos de borda.</span><span class="sxs-lookup"><span data-stu-id="521e3-136">[Azure IoT Hub](/azure/iot-hub/) handles device provisioning and messaging for the edge devices.</span></span> |
|  | <span data-ttu-id="521e3-137">Azure Time Series Insights</span><span class="sxs-lookup"><span data-stu-id="521e3-137">Azure Time Series Insights</span></span> | <span data-ttu-id="521e3-138">O [Azure Time Series Insights](/azure/time-series-insights/) armazena as mensagens do Hub IoT para visualização.</span><span class="sxs-lookup"><span data-stu-id="521e3-138">[Azure Time Series Insights](/azure/time-series-insights/) stores the messages from IoT Hub for visualization.</span></span> |
|  | <span data-ttu-id="521e3-139">Power BI</span><span class="sxs-lookup"><span data-stu-id="521e3-139">Power BI</span></span> | <span data-ttu-id="521e3-140">O [Microsoft Power BI](https://powerbi.microsoft.com/) fornece relatórios de negócios dos eventos de indisponibilidade de estoque.</span><span class="sxs-lookup"><span data-stu-id="521e3-140">[Microsoft Power BI](https://powerbi.microsoft.com/) provides business-focused reports of out of stock events.</span></span> <span data-ttu-id="521e3-141">O Power BI oferece uma interface de dashboard fácil de usar para exibir a saída do Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="521e3-141">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="521e3-142">Dispositivo Azure Stack Edge ou</span><span class="sxs-lookup"><span data-stu-id="521e3-142">Azure Stack Edge or</span></span><br><span data-ttu-id="521e3-143">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="521e3-143">Azure IoT Edge device</span></span> | <span data-ttu-id="521e3-144">Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="521e3-144">Azure IoT Edge</span></span> | <span data-ttu-id="521e3-145">O [Azure IoT Edge](/azure/iot-edge/) orquestra o runtime dos contêineres locais e manipula o gerenciamento de dispositivos e as atualizações.</span><span class="sxs-lookup"><span data-stu-id="521e3-145">[Azure IoT Edge](/azure/iot-edge/) orchestrates the runtime for the on-premises containers and handles device management and updates.</span></span>|
| | <span data-ttu-id="521e3-146">Project Brainwave do Azure</span><span class="sxs-lookup"><span data-stu-id="521e3-146">Azure project brainwave</span></span> | <span data-ttu-id="521e3-147">Em um dispositivo do Azure Stack Edge, o [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) usa FPGAs (matrizes de porta programável no campo) para acelerar a inferência de ML.</span><span class="sxs-lookup"><span data-stu-id="521e3-147">On an Azure Stack Edge device, [Project Brainwave](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) uses Field-Programmable Gate Arrays (FPGAs) to accelerate ML inferencing.</span></span>|

## <a name="issues-and-considerations"></a><span data-ttu-id="521e3-148">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="521e3-148">Issues and considerations</span></span>

<span data-ttu-id="521e3-149">Considere os seguintes pontos ao decidir como implementar essa solução:</span><span class="sxs-lookup"><span data-stu-id="521e3-149">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="521e3-150">Escalabilidade</span><span class="sxs-lookup"><span data-stu-id="521e3-150">Scalability</span></span>

<span data-ttu-id="521e3-151">A maioria dos modelos de machine learning pode ser executada somente em um determinado número de quadros por segundo, dependendo do hardware fornecido.</span><span class="sxs-lookup"><span data-stu-id="521e3-151">Most machine learning models can only run at a certain number of frames per second, depending on the provided hardware.</span></span> <span data-ttu-id="521e3-152">Determine a taxa de amostragem ideal de suas câmeras para garantir que o pipeline de ML não sofra atrasos.</span><span class="sxs-lookup"><span data-stu-id="521e3-152">Determine the optimal sample rate from your camera(s) to ensure that the ML pipeline doesn't back up.</span></span> <span data-ttu-id="521e3-153">Tipos diferentes de hardware processarão números diferentes de câmeras e taxas de quadros.</span><span class="sxs-lookup"><span data-stu-id="521e3-153">Different types of hardware will handle different numbers of cameras and frame rates.</span></span>

### <a name="availability"></a><span data-ttu-id="521e3-154">Disponibilidade</span><span class="sxs-lookup"><span data-stu-id="521e3-154">Availability</span></span>

<span data-ttu-id="521e3-155">É importante considerar o que poderá acontecer se o dispositivo de borda perder a conectividade.</span><span class="sxs-lookup"><span data-stu-id="521e3-155">It's important to consider what might happen if the edge device loses connectivity.</span></span> <span data-ttu-id="521e3-156">Considere quais dados poderão ser perdidos no Time Series Insights e no dashboard do Power BI.</span><span class="sxs-lookup"><span data-stu-id="521e3-156">Consider what data might be lost from the Time Series Insights and Power BI dashboard.</span></span> <span data-ttu-id="521e3-157">A solução de exemplo não foi projetada para ser altamente disponível.</span><span class="sxs-lookup"><span data-stu-id="521e3-157">The example solution as provided isn't designed to be highly available.</span></span>

### <a name="manageability"></a><span data-ttu-id="521e3-158">Capacidade de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="521e3-158">Manageability</span></span>

<span data-ttu-id="521e3-159">Essa solução pode abranger vários dispositivos e locais, o que pode ficar complicado.</span><span class="sxs-lookup"><span data-stu-id="521e3-159">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="521e3-160">Os serviços de Internet das Coisas do Azure podem colocar automaticamente novos locais e dispositivos online e mantê-los atualizados.</span><span class="sxs-lookup"><span data-stu-id="521e3-160">Azure's IoT services can automatically bring new locations and devices online and keep them up to date.</span></span> <span data-ttu-id="521e3-161">Procedimentos adequados de governança de dados também devem ser seguidos.</span><span class="sxs-lookup"><span data-stu-id="521e3-161">Proper data governance procedures must be followed as well.</span></span>

### <a name="security"></a><span data-ttu-id="521e3-162">Segurança</span><span class="sxs-lookup"><span data-stu-id="521e3-162">Security</span></span>

<span data-ttu-id="521e3-163">Esse padrão manipula dados potencialmente confidenciais.</span><span class="sxs-lookup"><span data-stu-id="521e3-163">This pattern handles potentially sensitive data.</span></span> <span data-ttu-id="521e3-164">Verifique se as chaves são revezadas regularmente e se as permissões na conta de Armazenamento do Azure e nos compartilhamentos locais estão definidas corretamente.</span><span class="sxs-lookup"><span data-stu-id="521e3-164">Make sure keys are regularly rotated and the permissions on the Azure Storage Account and local shares are correctly set.</span></span>

## <a name="next-steps"></a><span data-ttu-id="521e3-165">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="521e3-165">Next steps</span></span>

<span data-ttu-id="521e3-166">Para saber mais sobre os tópicos apresentados neste artigo:</span><span class="sxs-lookup"><span data-stu-id="521e3-166">To learn more about topics introduced in this article:</span></span>
- <span data-ttu-id="521e3-167">Vários serviços relacionados à IoT são usados neste padrão, incluindo o [Azure IoT Edge](/azure/iot-edge/), o [Hub IoT do Azure](/azure/iot-hub/) e o [Azure Time Series Insights](/azure/time-series-insights/).</span><span class="sxs-lookup"><span data-stu-id="521e3-167">Multiple IoT related services are used in this pattern, including [Azure IoT Edge](/azure/iot-edge/), [Azure IoT Hub](/azure/iot-hub/), and [Azure Time Series Insights](/azure/time-series-insights/).</span></span>
- <span data-ttu-id="521e3-168">Para saber mais sobre o Microsoft Project Brainwave, confira [o comunicado do blog](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) e assista ao [vídeo sore Machine Learning Acelerado do Azure com o Project Brainwave](https://www.youtube.com/watch?v=DJfMobMjCX0).</span><span class="sxs-lookup"><span data-stu-id="521e3-168">To learn more about Microsoft Project Brainwave, see [the blog announcement](https://blogs.microsoft.com/ai/build-2018-project-brainwave/) and checkout out the [Azure Accelerated Machine Learning with Project Brainwave video](https://www.youtube.com/watch?v=DJfMobMjCX0).</span></span>
- <span data-ttu-id="521e3-169">Confira as [Considerações de design de aplicativos híbridos](overview-app-design-considerations.md) para saber mais sobre as melhores práticas e obter respostas para outras perguntas.</span><span class="sxs-lookup"><span data-stu-id="521e3-169">See [Hybrid app design considerations](overview-app-design-considerations.md) to learn more about best practices and to get answers to any additional questions.</span></span>
- <span data-ttu-id="521e3-170">Confira a [família de produtos e soluções do Azure Stack](/azure-stack) para se informar melhor sobre todo o portfólio de produtos e soluções.</span><span class="sxs-lookup"><span data-stu-id="521e3-170">See the [Azure Stack family of products and solutions](/azure-stack) to learn more about the entire portfolio of products and solutions.</span></span>

<span data-ttu-id="521e3-171">Quando estiver pronto para testar a solução de exemplo, prossiga com o [Guia de implantação de solução de inferência de ML de borda](https://aka.ms/edgeinferencingdeploy).</span><span class="sxs-lookup"><span data-stu-id="521e3-171">When you're ready to test the solution example, continue with the [Edge ML inferencing solution deployment guide](https://aka.ms/edgeinferencingdeploy).</span></span> <span data-ttu-id="521e3-172">O guia de implantação fornece instruções passo a passo para a implantação e o teste de seus componentes.</span><span class="sxs-lookup"><span data-stu-id="521e3-172">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
